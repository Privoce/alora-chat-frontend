{"ast":null,"code":"import _regeneratorRuntime from \"/home/tulio/Documentos/projetosJs/privoce/react-socketio-nodejs-chatapp/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\n\nvar _marked =\n/*#__PURE__*/\n_regeneratorRuntime.mark(getConversationsFetch),\n    _marked2 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(resetConversationUnreadtMessagesSaga),\n    _marked3 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(setCurrentConversationSaga),\n    _marked4 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(deleteConversationFetchSaga);\n\nimport { takeLatest, takeEvery, put } from 'redux-saga/effects';\nimport { sendRequest } from 'modules/utils';\nimport { toast } from 'react-toastify';\nimport { GET_CONVERSATIONS, SET_CURRENT_CONVERSATION, RESET_CONVERSATION_UNREAD_MESSAGES, DELETE_CONVERSATION } from 'redux/constants/conversation';\nimport * as conversationActions from 'redux/actions/conversation';\nimport * as messageActions from 'redux/actions/message';\nimport constants from 'modules/constants';\n\nfunction getConversationsFetch() {\n  var response;\n  return _regeneratorRuntime.wrap(function getConversationsFetch$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.prev = 0;\n          _context.next = 3;\n          return sendRequest({\n            url: \"\".concat(constants.API.ROOT).concat(constants.API.ACTIONS.CONVERSATION),\n            method: constants.API.METHODS.GET\n          });\n\n        case 3:\n          response = _context.sent;\n          _context.next = 6;\n          return put(conversationActions.getConversationsReceived({\n            result: response.result\n          }));\n\n        case 6:\n          _context.next = 13;\n          break;\n\n        case 8:\n          _context.prev = 8;\n          _context.t0 = _context[\"catch\"](0);\n          _context.next = 12;\n          return put(conversationActions.getConversationsReceived({\n            result: []\n          }));\n\n        case 12:\n          toast.error(constants.LABELS.MAIN.GLOBAL_ERROR);\n\n        case 13:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked, this, [[0, 8]]);\n}\n\nfunction resetConversationUnreadtMessagesSaga(action) {\n  var partner, body;\n  return _regeneratorRuntime.wrap(function resetConversationUnreadtMessagesSaga$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          partner = action.params.partner;\n          body = {\n            partnerId: partner._id,\n            conversation: {\n              unreadMessages: 0\n            }\n          };\n          _context2.prev = 2;\n          _context2.next = 5;\n          return sendRequest({\n            url: \"\".concat(constants.API.ROOT).concat(constants.API.ACTIONS.CONVERSATION),\n            method: constants.API.METHODS.PUT,\n            body: body\n          });\n\n        case 5:\n          _context2.next = 10;\n          break;\n\n        case 7:\n          _context2.prev = 7;\n          _context2.t0 = _context2[\"catch\"](2);\n          toast.error(constants.LABELS.MAIN.GLOBAL_ERROR);\n\n        case 10:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, _marked2, this, [[2, 7]]);\n}\n\nfunction setCurrentConversationSaga(action) {\n  var partner, partnerId;\n  return _regeneratorRuntime.wrap(function setCurrentConversationSaga$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          partner = action.params.partner;\n          partnerId = partner._id;\n          _context3.next = 4;\n          return put(messageActions.getMessages({\n            partnerId: partnerId\n          }));\n\n        case 4:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, _marked3, this);\n}\n\nfunction deleteConversationFetchSaga(action) {\n  var params, partnerId, body;\n  return _regeneratorRuntime.wrap(function deleteConversationFetchSaga$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          params = action.params;\n          partnerId = params.partnerId;\n          body = {\n            partnerId: partnerId\n          };\n          _context4.prev = 3;\n          _context4.next = 6;\n          return sendRequest({\n            url: \"\".concat(constants.API.ROOT).concat(constants.API.ACTIONS.CONVERSATION),\n            method: constants.API.METHODS.DELETE,\n            body: body\n          });\n\n        case 6:\n          _context4.next = 8;\n          return put(conversationActions.deleteConversationReceived());\n\n        case 8:\n          _context4.next = 10;\n          return put(conversationActions.removeConversation({\n            partnerId: partnerId\n          }));\n\n        case 10:\n          _context4.next = 17;\n          break;\n\n        case 12:\n          _context4.prev = 12;\n          _context4.t0 = _context4[\"catch\"](3);\n          _context4.next = 16;\n          return put(conversationActions.deleteConversationReceived());\n\n        case 16:\n          toast.error(constants.LABELS.MAIN.GLOBAL_ERROR);\n\n        case 17:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, _marked4, this, [[3, 12]]);\n}\n\nvar sagas = [takeLatest(GET_CONVERSATIONS, getConversationsFetch), takeLatest(SET_CURRENT_CONVERSATION, setCurrentConversationSaga), takeEvery(RESET_CONVERSATION_UNREAD_MESSAGES, resetConversationUnreadtMessagesSaga), takeEvery(DELETE_CONVERSATION, deleteConversationFetchSaga)];\nexport default sagas;","map":{"version":3,"sources":["/home/tulio/Documentos/projetosJs/privoce/react-socketio-nodejs-chatapp/client/src/redux/sagas/conversation/index.js"],"names":["getConversationsFetch","resetConversationUnreadtMessagesSaga","setCurrentConversationSaga","deleteConversationFetchSaga","takeLatest","takeEvery","put","sendRequest","toast","GET_CONVERSATIONS","SET_CURRENT_CONVERSATION","RESET_CONVERSATION_UNREAD_MESSAGES","DELETE_CONVERSATION","conversationActions","messageActions","constants","url","API","ROOT","ACTIONS","CONVERSATION","method","METHODS","GET","response","getConversationsReceived","result","error","LABELS","MAIN","GLOBAL_ERROR","action","partner","params","body","partnerId","_id","conversation","unreadMessages","PUT","getMessages","DELETE","deleteConversationReceived","removeConversation","sagas"],"mappings":"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","sourcesContent":["import {\n\ttakeLatest,\n\ttakeEvery,\n\tput\n} from 'redux-saga/effects';\n\nimport {\n\tsendRequest\n} from 'modules/utils';\n\nimport {\n\ttoast\n} from 'react-toastify';\n\nimport {\n\tGET_CONVERSATIONS,\n\tSET_CURRENT_CONVERSATION,\n\tRESET_CONVERSATION_UNREAD_MESSAGES,\n\tDELETE_CONVERSATION\n} from 'redux/constants/conversation';\n\nimport * as conversationActions from 'redux/actions/conversation';\nimport * as messageActions from 'redux/actions/message';\nimport constants from 'modules/constants';\n\nfunction* getConversationsFetch () {\n\ttry {\n\t\tconst response = yield sendRequest({\n\t\t\turl: `${constants.API.ROOT}${constants.API.ACTIONS.CONVERSATION}`,\n\t\t\tmethod: constants.API.METHODS.GET\n\t\t});\n\n\t\tyield put(conversationActions.getConversationsReceived({\n\t\t\tresult: response.result\n\t\t}));\n\t} catch (e) {\n\t\tyield put(conversationActions.getConversationsReceived({\n\t\t\tresult: []\n\t\t}));\n\t\ttoast.error(constants.LABELS.MAIN.GLOBAL_ERROR);\n\t}\n}\n\nfunction* resetConversationUnreadtMessagesSaga (action) {\n\tconst {\n\t\tpartner\n\t} = action.params;\n\n\tconst body = {\n\t\tpartnerId: partner._id,\n\t\tconversation: {\n\t\t\tunreadMessages: 0\n\t\t}\n\t};\n\n\ttry {\n\t\tyield sendRequest({\n\t\t\turl: `${constants.API.ROOT}${constants.API.ACTIONS.CONVERSATION}`,\n\t\t\tmethod: constants.API.METHODS.PUT,\n\t\t\tbody\n\t\t});\n\t} catch (e) {\n\t\ttoast.error(constants.LABELS.MAIN.GLOBAL_ERROR);\n\t}\n}\n\nfunction* setCurrentConversationSaga(action) {\n\tconst {\n\t\tpartner\n\t} = action.params;\n\n\tconst {\n\t\t_id: partnerId\n\t} = partner;\n\n\tyield put(messageActions.getMessages({\n\t\tpartnerId\n\t}));\n}\n\nfunction* deleteConversationFetchSaga(action) {\n\tconst {\n\t\tparams\n\t} = action;\n\n\tconst {\n\t\tpartnerId\n\t} = params;\n\n\tconst body = {\n\t\tpartnerId\n\t};\n\n\ttry {\n\t\tyield sendRequest({\n\t\t\turl: `${constants.API.ROOT}${constants.API.ACTIONS.CONVERSATION}`,\n\t\t\tmethod: constants.API.METHODS.DELETE,\n\t\t\tbody\n\t\t});\n\n\t\tyield put(conversationActions.deleteConversationReceived());\n\t\tyield put(conversationActions.removeConversation({\n\t\t\tpartnerId\n\t\t}));\n\t} catch (e) {\n\t\tyield put(conversationActions.deleteConversationReceived());\n\t\ttoast.error(constants.LABELS.MAIN.GLOBAL_ERROR);\n\t}\n}\n\nconst sagas = [\n\ttakeLatest(GET_CONVERSATIONS, getConversationsFetch),\n\ttakeLatest(SET_CURRENT_CONVERSATION, setCurrentConversationSaga),\n\ttakeEvery(RESET_CONVERSATION_UNREAD_MESSAGES, resetConversationUnreadtMessagesSaga),\n\ttakeEvery(DELETE_CONVERSATION, deleteConversationFetchSaga)\n];\n\nexport default sagas;\n"]},"metadata":{},"sourceType":"module"}